),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
filter(YEAR %in% 2020) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
years <- 2017:2021
quarters <- 1:4
types <- c("Electric","Gas")
pge_data_raw <- NULL
for(year in years){
for(quarter in quarters){
for(type in types){
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
if(!file.exists(filename)) next
temp <- read_csv(filename)
if(type == "Electric"){
temp<-
temp%>%
#conversion: 1 kWH = 3.41213 kBTU
mutate(TOTALKBTU =  TOTALKWH*3.41214)%>%
select(-TOTALKWH, -AVERAGEKWH)
}
if(type == "Gas") {
temp <-
temp %>%
#conversion: 1 Therm = 99.9761 kBTU
mutate(TOTALKBTU = TOTALTHM * 99.9761) %>%
select(-TOTALTHM, -AVERAGETHM)
}
pge_data_raw <-
rbind(pge_data_raw,temp)
}
}
}
pge_data <-
pge_data_raw %>%
filter(
CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential","Elec- Commercial","Gas- Commercial")
) %>%
group_by(
YEAR,
MONTH,
CUSTOMERCLASS
) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
mutate(
DATE =
paste(
YEAR,
MONTH,
"01",
sep="-"
) %>% as.Date()
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Commercial","Gas- Commercial")) %>%
filter(YEAR %in% c(2017, 2018)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Commercial Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
filter(YEAR %in% c(2017, 2018)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
filter(YEAR %in% c(2019, 2020)) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2019-2020",
color = "Energy Type"
)
#line gragh
pge_data %>%
filter(CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential")) %>%
ggplot() +
geom_line(
aes(
x = DATE,
y = TOTALKBTU,
color = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Date",
y = "kBTU",
title = "PG&E Residential Yearly Electricity & Gas Usage 2017-2021",
color = "Energy Type"
)
setwd("~/Desktop/GitHub/kflorsheim.github.io")
library(tigris)
library(tidyverse)
library(sf)
library(mapview)
library(leaflet)
library(censusapi)
knitr::opts_chunk$set(echo = F, warning = F, message = F)
years <- 2017:2021
quarters <- 1:4
types <- c("Electric","Gas")
pge_data_raw <- NULL
for(year in years){
for(quarter in quarters){
for(type in types){
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
if(!file.exists(filename)) next
temp <- read_csv(filename)
if(type == "Electric"){
temp<-
temp%>%
#conversion: 1 kWH = 3.41213 kBTU
mutate(TOTALKBTU =  TOTALKWH*3.41214)%>%
select(-TOTALKWH, -AVERAGEKWH)
}
if(type == "Gas") {
temp <-
temp %>%
#conversion: 1 Therm = 99.9761 kBTU
mutate(TOTALKBTU = TOTALTHM * 99.9761) %>%
select(-TOTALTHM, -AVERAGETHM)
}
pge_data_raw <-
rbind(pge_data_raw,temp)
}
}
}
pge_data <-
pge_data_raw %>%
filter(
CUSTOMERCLASS %in% c("Elec- Residential","Gas- Residential","Elec- Commercial","Gas- Commercial")
) %>%
group_by(
YEAR,
MONTH,
CUSTOMERCLASS
) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
mutate(
DATE =
paste(
YEAR,
MONTH,
"01",
sep="-"
) %>% as.Date()
)
setwd("~/Desktop/GitHub/kflorsheim.github.io/Homework 1 Gas & Electric/Homework1")
