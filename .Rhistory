fillColor = ~pm25_pal(PM2.5),
color = "white",
weight = 0.5,
fillOpacity = 0.5,
label = ~PM2.5
)
bay_county_names <-
c(
"Alameda",
"Contra Costa",
"Marin",
"Napa",
"San Francisco",
"San Mateo",
"Santa Clara",
"Solano",
"Sonoma"
)
ca_tracts <- tracts("CA", cb = T, progress_bar = F)
ces4_bay_pm25 <-
ces4 %>%
filter(`California County` %in% bay_county_names) %>%
select(`Census Tract`, PM2.5) %>%
left_join(
ca_tracts %>%
transmute(GEOID = as.numeric(GEOID)),
by = c("Census Tract" = "GEOID")
) %>%
st_as_sf()
pm25_pal <- colorNumeric(
palette = "Reds",
domain = ces4_bay_pm25$PM2.5
)
leaflet() %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = ces4_bay_pm25,
fillColor = ~pm25_pal(PM2.5),
color = "white",
weight = 0.5,
fillOpacity = 0.5,
label = ~PM2.5
)
temp <- tempfile()
download.file("https://oehha.ca.gov/media/downloads/calenviroscreen/document/calenviroscreen40resultsdatadictionaryf2021.zip",destfile = temp)
ces4 <- read_excel("calenviroscreen40resultsdatadictionary_F_2021.xlsx")
colnames(ces4)
ces4_clean <- ces4 %>%
dplyr::select(!ends_with("Pctl"))
sum(is.na(ces4_clean$Poverty))
ces4_clean %>%
# .$Poverty %>%
pull(Poverty) %>%
is.na() %>%
sum()
ca_tracts <- tracts("CA")
ces4_map <- ces4_clean %>%
filter(`California County` %in% bay_county_names) %>%
select(`Census Tract`, PM2.5) %>%
left_join(
ca_tracts %>%
transmute(GEOID = GEOID %>% as.numeric()),
by = c("Census Tract" = "GEOID")
) %>%
st_as_sf()
mapview(ces4_map, zcol = "Asthma")
temp <- tempfile()
download.file("https://oehha.ca.gov/media/downloads/calenviroscreen/document/calenviroscreen40resultsdatadictionaryf2021.zip",destfile = temp)
ces4 <- read_excel("calenviroscreen40resultsdatadictionary_F_2021.xlsx")
colnames(ces4)
ces4_clean <- ces4 %>%
dplyr::select(!ends_with("Pctl"))
sum(is.na(ces4_clean$Poverty))
ces4_clean %>%
# .$Poverty %>%
pull(Poverty) %>%
is.na() %>%
sum()
ca_tracts <- tracts("CA")
ces4_map <- ces4_clean %>%
filter(`California County` %in% bay_county_names) %>%
select(`Census Tract`, Asthma) %>%
left_join(
ca_tracts %>%
transmute(GEOID = GEOID %>% as.numeric()),
by = c("Census Tract" = "GEOID")
) %>%
st_as_sf()
mapview(ces4_map, zcol = "Asthma")
View(ces4_clean)
View(ces4_bay_pm25)
View(ces4_clean)
ggplot() +
geom_point(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
)
ggplot() +
geom_point(
data = ces4_clean,
aes(
x = geom_smooth(PM2.5),
y = Asthma
)
)
ggplot() +
geom_point(
data = geom_smooth(ces4_clean),
aes(
x = PM2.5,
y = Asthma
)
)
ggplot() +
geom_point(
data = ces4_clean,
geom_smooth(aes(
x = PM2.5,
y = Asthma
))
)
ggplot() +
geom_point(
data = ces4_clean,
aes(
geom_smooth(
x = PM2.5,
y = Asthma
))
)
ggplot() +
geom_point(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
)
ggplot() +
geom_point(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm")
ggplot() +
data = ces4_clean,
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm")
slope <- 0
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$PM2.5 - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 0
yintercept <- mean(ces4$Asthma)
best_fit_candidate <- slope * ces4$PM2.5 + yintercept
residuals <- ces4$PM2.5 - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
ces4_bay_pm25 <-
ces4 %>%
filter(`California County` %in% bay_county_names) %>%
select(`Census Tract`, PM2.5) %>%
left_join(
ca_tracts %>%
transmute(GEOID = as.numeric(GEOID)),
by = c("Census Tract" = "GEOID")
) %>%
st_as_sf()
pm25_pal <- colorNumeric(
palette = "Reds",
domain = ces4_bay_pm25$PM2.5
)
leaflet() %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = ces4_bay_pm25,
fillColor = ~pm25_pal(PM2.5),
color = "white",
weight = 0.5,
fillOpacity = 0.5,
label = ~PM2.5
)
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 0
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
slope <- 0
yintercept <- mean(ces4_clean$PM2.5)
best_fit_candidate <- slope * ces4_clean$Asthma + yintercept
residuals <- ces4_clean$PM2.5 - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 66
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 2
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 0
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 0
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
get_sumsq_residuals <- function(x){
slope <- x[1]
yintercept <- x[2]
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
}
ggplot(
data = ces4_clean,
aes(
x = PM2.5,
y = Asthma
)
) +
geom_point() +
geom_smooth(method = "lm") +
geom_line(
aes(
x = ces4_clean$PM2.5,
y = best_fit_candidate
),
color = "red",
size = 1
)
slope <- 0
yintercept <- mean(ces4_clean$Asthma)
best_fit_candidate <- slope * ces4_clean$PM2.5 + yintercept
residuals <- ces4_clean$Asthma - best_fit_candidate
sumsq_residuals <- sum(residuals^2)
sumsq_residuals
model <- lm(Asthma ~ PM2.5, ces4_clean)
summary(model)
