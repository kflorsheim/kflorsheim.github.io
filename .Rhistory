pums_pal <- colorNumeric(
palette = "GnBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 2,
opacity = 1
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 2,
opacity = 1
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 2,
opacity = .75
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 2,
opacity = .2
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
bay_pums_a <-
bay_pums %>%
filter(!duplicated(SERIALNO)) %>%
mutate(
PWGTP = as.numeric(PWGTP),
Over59_NoRunningWater = ifelse(
(AGEP > 59) &
(RWAT == 2),
PWGTP,
0
)
) %>%
group_by(PUMA) %>%
summarize(
sum_Over59_NoRunningWater =
sum(Over59_NoRunningWater, na.rm =T)
) %>%
left_join(
bay_pumas %>%
select(PUMACE10),
by = c("PUMA" = "PUMACE10")
) %>%
st_as_sf()
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "pink",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = bay_pums_a,
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
data = bay_pums_a,
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
sum_Over59_NoRunningWater =
sum(Over59_NoRunningWater, na.rm =T)
sum_Over59_NoRunningWater =
sum(Over59_NoRunningWater)
sum_Over59_NoRunningWater =
sum(bay_pums_a)
sum_Over59_NoRunningWater =
sum(sum_Over59_NoRunningWater)
sum_Over59_NoRunningWater =
sum(~sum_Over59_NoRunningWater)
sum_Over59_NoRunningWater =
sumsum(~Over59_NoRunningWater, na.rm =T)
sum_Over59_NoRunningWater =
sum(~Over59_NoRunningWater, na.rm =T)
sum_Over59_NoRunningWater =
sum(Over59_NoRunningWater, na.rm =T)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet(bay_pums_a) %>%
addTiles() %>%
addPolygons(
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
View(bay_pumas)
View(bay_pumas)
View(bay_pums)
View(bay_pums)
View(bay_pums_a)
View(bay_pums_a)
sum_Over59_NoRunningWater =
sum(PUMA, na.rm =T)
sum_Over59_NoRunningWater =
sum(PUMA)
sum_Over59_NoRunningWater =
sum(~PUMA)
sum_Over59_NoRunningWater =
sum(bay_pums_a(sum_Over59_NoRunningWater))
sum_Over59_NoRunningWater =
sum(~bay_pums_a(sum_Over59_NoRunningWater))
sum_Over59_NoRunningWater =
sum(bay_pums_a$sum_Over59_NoRunningWater)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet(bay_pums_a) %>%
addTiles() %>%
addPolygons(
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
pums_2019_1yr <- getCensus(
name = "acs/acs1/pums",
vintage = 2019,
region = "public use microdata area:*",
regionin = "state:06",
vars = c(
"SERIALNO", #Unique ID for each househole
"SPORDER",
"PWGTP", #Total number of people
"WGTP",
"AGEP",  #Age Data
"RWAT" #Hot and Cold Running Water Data
)
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet(bay_pums_a) %>%
addTiles() %>%
addPolygons(
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Number of people over the age of 59 living without running water"
)
View(bay_pums_a)
View(bay_pums_a)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet(bay_pums_a) %>%
addTiles() %>%
addPolygons(
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Population 60 Years and Older Living without Running Water"
)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet(bay_pums_a) %>%
addTiles() %>%
addPolygons(
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Population 60 Years and Older Living without Running Water"
)
temp <- tempfile()
download.file("https://www2.census.gov/programs-surveys/acs/data/pums/2019/1-Year/csv_hca.zip",destfile = temp)
pums_hca_2019_1yr <- read_csv(unzip(temp,"psam_h06.csv"))
unlink(temp)
pums_pal <- colorNumeric(
palette = "PuBu",
domain = bay_pums_a$sum_Over59_NoRunningWater
)
leaflet(bay_pums_a) %>%
addTiles() %>%
addPolygons(
fillColor = ~pums_pal(sum_Over59_NoRunningWater),
color = "black",
opacity = 0.5,
fillOpacity = 0.5,
weight = 1,
label = ~paste0(
round(sum_Over59_NoRunningWater),
" people over the age of 59 living without running water"
),
highlightOptions = highlightOptions(
weight = 1,
opacity = .5
)
) %>%
addLegend(
pal = pums_pal,
values = ~sum_Over59_NoRunningWater,
title = "Population 60 Years and Older Living without Running Water"
)
sum_Over59_NoRunningWater =
sum(bay_pums_a$sum_Over59_NoRunningWater)
bay_pums_a <-
bay_pums %>%
filter(!duplicated(SERIALNO)) %>%
mutate(
PWGTP = as.numeric(PWGTP),
Over59_NoRunningWater = ifelse(
(AGEP > 59) &
(RWAT == 2), #People living without Hot and Cold Running Water
PWGTP,
0
)
) %>%
group_by(PUMA) %>%
summarize(
sum_Over59_NoRunningWater =
sum(Over59_NoRunningWater, na.rm =T)
) %>%
left_join(
bay_pumas %>%
select(PUMACE10),
by = c("PUMA" = "PUMACE10")
) %>%
st_as_sf()
ca_pumas <-
pumas("CA", cb = T, progress_bar = F)
bay_county_names <-
c(
"Alameda",
"Contra Costa",
"Marin",
"Napa",
"San Francisco",
"San Mateo",
"Santa Clara",
"Solano",
"Sonoma"
)
bay_counties <-
counties("CA", cb = T, progress_bar = F) %>%
filter(NAME %in% bay_county_names)
bay_pumas <-
ca_pumas %>%
st_centroid() %>%
.[bay_counties, ] %>%
st_drop_geometry() %>%
left_join(ca_pumas %>% select(GEOID10)) %>%
st_as_sf()
bay_pums <-
pums_2019_1yr %>%
mutate(
PUMA = str_pad(public_use_microdata_area,5,"left","0")
) %>%
filter(PUMA %in% bay_pumas$PUMACE10)
